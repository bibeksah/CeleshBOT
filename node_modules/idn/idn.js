var tables = {
    "cn_zh": require("./cn_zh.js"),
    "tw_zh": require("./tw_zh.js")
};

tables["cn_zh"]['讎'] = [ [ '雠' ], [ '讐', '仇' ] ];
tables["cn_zh"]['餘'] = [ [ '馀' ], [ '余' ] ];
tables["tw_zh"]['丛'] = [ [ '叢' ], [ '藂', '欉' ] ];
tables["tw_zh"]['仑'] = [ [ '侖' ], [ '崘', '崙' ] ];
tables["tw_zh"]['冲'] = [ [ '衝' ], [ '沖', '祌', '衶', '盅' ] ];
tables["tw_zh"]['别'] = [ [ '別' ], [ '憋', '彆' ] ];
tables["tw_zh"]['卤'] = [ [ '滷' ], [ '鹵' ] ];
tables["tw_zh"]['历'] = [ [ '歷' ], [ '厤', '暦', '歴', '曆' ] ];
tables["tw_zh"]['发'] = [ [ '發' ], [ '彂', '髪', '髮' ] ];
tables["tw_zh"]['叹'] = [ [ '嘆' ], [ '歎' ] ];
tables["tw_zh"]['团'] = [ [ '團' ], [ '団', '糰' ] ];
tables["tw_zh"]['坛'] = [ [ '壇' ], [ '罎', '罈' ] ];
tables["tw_zh"]['墙'] = [ [ '墻' ], [ '牆' ] ];
tables["tw_zh"]['尝'] = [ [ '嘗' ], [ '甞', '嚐' ] ];
tables["tw_zh"]['尽'] = [ [ '儘' ], [ '盡' ] ];
tables["tw_zh"]['当'] = [ [ '當' ], [ '噹' ] ];
tables["tw_zh"]['录'] = [ [ '彔' ], [ '録', '錄' ] ];
tables["tw_zh"]['恶'] = [ [ '惡' ], [ '悪', '噁' ] ];
tables["tw_zh"]['汇'] = [ [ '匯' ], [ '彚', '滙', '彙' ] ];
tables["tw_zh"]['签'] = [ [ '簽' ], [ '籖', '籤' ] ];
tables["tw_zh"]['脏'] = [ [ '臟' ], [ '髒' ] ];
tables["tw_zh"]['苏'] = [ [ '蘇' ], [ '甦', '囌', '蘓' ] ];
tables["tw_zh"]['获'] = [ [ '獲' ], [ '穫' ] ];
tables["tw_zh"]['赞'] = [ [ '贊' ], [ '讃', '賛', '讚' ] ];
tables["tw_zh"]['迹'] = [ [ '跡' ], [ '蹟' ] ];
tables["tw_zh"]['钟'] = [ [ '鍾' ], [ '螤', '鈡', '锺', '鐘' ] ];
tables["tw_zh"]['铺'] = [ [ '鋪' ], [ '舖' ] ];
tables["tw_zh"]['须'] = [ [ '須' ], [ '鬚' ] ];
tables["tw_zh"]['馈'] = [ [ '饋' ], [ '餽' ] ];

function normalize(o) {
    for(var n in o) {
        o[n][0].length > 1 && o[n][0].indexOf(n) >= 0 && (o[n][0] = [n]);
        o[n][1] = o[n][1].filter(s => o[n][0].indexOf(s) < 0);
    }
}

normalize(tables["cn_zh"]);
normalize(tables["tw_zh"]);

function idn(IN, L) {
    var PV = {};
    var CV = {};

    for(var m in L) {
        var l = L[m];

        PV[l] = [];
        CV[l] = [];

        for(var n in IN) {
            var np = tables[l][IN[n]];
            if(!np) return null;

            PV[l].push(np[0]);
            CV[l].push(np[0].concat(np[1]));
        }
    }

    return {PV, CV};
}

module.exports = idn;
