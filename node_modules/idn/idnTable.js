var idn      = require('./idn.js');
var combiner = require('./combiner.js');
var onlyOne  = require('./onlyOne.js');
var concat   = require('./concat.js');

function idnTable(IN, L) {
    L = L || ["cn_zh", "tw_zh"];

    var TB = idn(IN, L);
    if(!TB) return null;

    var ZV = [IN];
    for(var l in TB.PV) {
        ZV = ZV.concat(combiner(TB.PV[l]));
    }
    ZV = onlyOne(ZV);

    var CVall = combiner(concat(TB.CV, IN.length))
               .filter(s => ZV.indexOf(s) < 0);

    return {IN, L, ZV, CVall};
}

module.exports = idnTable;
